(this.webpackJsonpbattlecry3=this.webpackJsonpbattlecry3||[]).push([[0],{26:function(e,t,n){e.exports=n(37)},31:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(22),s=n.n(r),o=(n(31),n(3)),c=n(4),l=n(6),h=n(5),u=n(7),d=n(10),g=n(11),x=n(16),v=n(12),f=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(h.a)(t).call(this))).handleSubmit=function(t){t.preventDefault(),e.props.onLoginClicked(),e.props.onLogin(),e.props.onSetCurrentPlayer(e.state.currentPlayer),e.setSubmitted()},e.setSubmitted=function(){e.setState(Object(v.a)({},e.state,{submitted:!0}))},e.handleChange=function(t){e.setState(Object(v.a)({},e.state,{currentPlayer:Object(v.a)({},e.state.currentPlayer,Object(x.a)({},t.target.id,t.target.value))}))},e.state={currentPlayer:{name:""},submitted:!1},e}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return!0===this.props.loginClicked&&!1===this.state.submitted?i.a.createElement("div",null,i.a.createElement("h1",null,"Login"),i.a.createElement("form",{onSubmit:function(t){return e.handleSubmit(t)}},i.a.createElement("input",{type:"text",placeholder:"Name",onChange:function(t){return e.handleChange(t)},id:"name"}),i.a.createElement("input",{type:"submit",value:"Submit"})),i.a.createElement("button",null,"Cancel")):!0===this.state.submitted?i.a.createElement(g.a,{to:"/gameselect"}):i.a.createElement(i.a.Fragment,null)}}]),t}(a.Component),y=n(25),b=n(15),m=['{"q":-1,"r":-3,"s":4}','{"q":-1,"r":-2,"s":3}','{"q":0,"r":-2,"s":2}','{"q":1,"r":-3,"s":2}','{"q":1,"r":-2,"s":1}','{"q":3,"r":-3,"s":0}','{"q":3,"r":-2,"s":-1}','{"q":4,"r":-2,"s":2}','{"q":5,"r":-2,"s":-3}','{"q":8,"r":-3,"s":-5}','{"q":3,"r":0,"s":-3}','{"q":2,"r":1,"s":-3}','{"q":2,"r":2,"s":-4}','{"q":3,"r":1,"s":-4}','{"q":3,"r":2,"s":-5}','{"q":4,"r":1,"s":-5}','{"q":5,"r":0,"s":-5}','{"q":4,"r":2,"s":-6}','{"q":-1,"r":3,"s":-2}','{"q":0,"r":1,"s":-1}','{"q":-0,"r":0,"s":-0}','{"q":-1,"r":0,"s":1}','{"q":-1,"r":1,"s":0}','{"q":-2,"r":1,"s":1}','{"q":-3,"r":2,"s":1}','{"q":-5,"r":0,"s":5}'],H=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(h.a)(t).call(this,e))).handleMouseMove=n.handleMouseMove.bind(Object(b.a)(n)),n.handleClick=n.handleClick.bind(Object(b.a)(n)),n.state={hexSize:30,hexOrigin:{x:300,y:250},currentHex:{q:0,r:0,s:0,x:0,y:0},playerPosition:{q:0,r:0,s:0,x:0,y:0},forestHexes:m,greyHexes:[],blueHexes:[],playerTurn:1,phase:"movement",cubeNeighborsArray:[],infantryDistance:6,greyUnitHealth:4,blueUnitHealth:4,firingDistance:0,currentGame:1,clickCoordsHolder:[],previousPlayerPosition:{q:0,r:0,s:0}},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){var e=this.getHexParameters();this.setState({canvasSize:{canvasWidth:680,canvasHeight:500},hexParameters:e})}},{key:"componentDidMount",value:function(){var e=this,t=this.props.id,n=this.state.canvasSize,a=n.canvasWidth,i=n.canvasHeight;this.canvasHex.width=a,this.canvasHex.height=i,this.canvasCoordinates.width=a,this.canvasCoordinates.height=i,this.getCanvasPosition(this.canvasCoordinates),this.drawHexes(),this.setState({currentGame:t}),fetch("http://localhost:3000/units").then((function(e){return e.json()})).then((function(t){e.setState({greyHexes:t.filter((function(t){return"Confederate"==t.nation&&t.game_id==e.state.currentGame})).map((function(e){return JSON.parse(e.coords)})),blueHexes:t.filter((function(t){return"Union"==t.nation&&t.game_id==e.state.currentGame})).map((function(e){return JSON.parse(e.coords)}))},(function(){e.drawForestHexes(),e.drawBlueUnitHexes(),e.drawGreyUnitHexes(),console.log(e.state.currentGame)}))}))}},{key:"shouldComponentUpdate",value:function(e,t){if(t.currentHex!==this.state.currentHex){var n=t.currentHex,a=n.q,i=n.r,r=n.s,s=n.x,o=n.y,c=this.state.canvasSize,l=c.canvasWidth,h=c.canvasHeight;this.canvasCoordinates.getContext("2d").clearRect(0,0,l,h),this.drawNeighborsMove(this.Hex(a,i,r));var u=t.currentDistanceLine;if(null!=u)for(var d=0;d<=u.length-2;d++)0==d||this.drawHex(this.canvasCoordinates,this.Point(u[d].x,u[d].y),"lime",1,"orange");return this.drawHex(this.canvasCoordinates,this.Point(s,o),"lime",1,"lime"),!0}return!1}},{key:"drawHexes",value:function(){for(var e=this.state.canvasSize,t=(e.canvasWidth,e.canvasHeight,this.state.hexParameters),n=(t.hexWidth,t.hexHeight,t.vertDist,t.horizDist,this.state.hexOrigin,0),a=0;a<=4;a++){a%2==0&&0!==a&&n++;for(var i=-5;i<=6;i++){var r=this.hexToPixel(this.Hex(i-n,a,-i-a)),s=r.x,o=r.y;this.drawHex(this.canvasHex,this.Point(s,o),"black",1,"grey")}}for(var c=0,l=-1;l>=-4;l--){l%2!==0&&c++;for(var h=-5;h<=6;h++){var u=this.hexToPixel(this.Hex(h+c,l)),d=u.x,g=u.y;this.drawHex(this.canvasHex,this.Point(d,g),"black",1,"grey")}}}},{key:"drawHex",value:function(e,t,n,a,i){for(var r=0;r<=5;r++){var s=this.getHexCornerCoord(t,r),o=this.getHexCornerCoord(t,r+1);this.fillHex(e,t,i),this.drawLine(e,s,o,n,a)}}},{key:"drawForestHexes",value:function(){var e=this;this.state.forestHexes.map((function(t){var n=JSON.parse(t),a=n.q,i=n.r,r=n.s,s=e.hexToPixel(e.Hex(a,i,r)),o=s.x,c=s.y;e.drawHex(e.canvasHex,e.Point(o,c),1,"black","green")}))}},{key:"drawGreyUnitHexes",value:function(){var e=this;this.state.greyHexes.map((function(t){var n=t.q,a=t.r,i=t.s,r=e.hexToPixel(e.Hex(n,a,i)),s=r.x,o=r.y;e.drawHex(e.canvasHex,e.Point(s,o),1,"black","red")}))}},{key:"drawBlueUnitHexes",value:function(){var e=this;this.state.blueHexes.map((function(t){var n=t.q,a=t.r,i=t.s,r=e.hexToPixel(e.Hex(n,a,i)),s=r.x,o=r.y;e.drawHex(e.canvasHex,e.Point(s,o),1,"black","blue")}))}},{key:"fetchNewUnitPosition",value:function(e,t,n){console.log(e,t,n);var a='{"q":'.concat(e,',"r":').concat(t,',"s":').concat(n,"}");fetch("http://localhost:3000/units/3",{method:"PATCH",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({name:"1st Mississippi",coords:a,health:4,nation:"Confederate",game_id:1})}).then((function(e){1===Math.floor(e.status/200)?console.log("Great "):console.log("ERROR",e)})),console.log("here")}},{key:"getHexCornerCoord",value:function(e,t){var n=60*t+30,a=Math.PI/180*n,i=e.x+this.state.hexSize*Math.cos(a),r=e.y+this.state.hexSize*Math.sin(a);return this.Point(i,r)}},{key:"getHexParameters",value:function(){var e=2*this.state.hexSize,t=Math.sqrt(3)/2*e;return{hexWidth:t,hexHeight:e,vertDist:3*e/4,horizDist:t}}},{key:"getCanvasPosition",value:function(e){var t=e.getBoundingClientRect();this.setState({canvasPosition:{left:t.left,right:t.right,top:t.top,bottom:t.bottom}})}},{key:"hexToPixel",value:function(e){var t=this.state.hexOrigin,n=this.state.hexSize*Math.sqrt(3)*(e.q+e.r/2)+t.x,a=3*this.state.hexSize/2*e.r+t.y;return this.Point(n,a)}},{key:"pixelToHex",value:function(e){var t=this.state.hexSize,n=this.state.hexOrigin,a=((e.x-n.x)*Math.sqrt(3)/3-(e.y-n.y)/3)/t,i=2*(e.y-n.y)/3/t;return this.Hex(a,i,-a-i)}},{key:"cubeDirection",value:function(e){return[this.Hex(1,0,-1),this.Hex(1,-1,0),this.Hex(0,-1,1),this.Hex(-1,0,1),this.Hex(-1,1,0),this.Hex(0,1,-1)][e]}},{key:"cubeAdd",value:function(e,t){return this.Hex(e.q+t.q,e.r+t.r,e.s+t.s)}},{key:"cubeSubtract",value:function(e,t){return this.Hex(e.q-t.q,e.r-t.r,e.s-t.s)}},{key:"getCubeNeighbor",value:function(e,t){return this.cubeAdd(e,this.cubeDirection(t))}},{key:"cubeRound",value:function(e){var t=Math.round(e.q),n=Math.round(e.r),a=Math.round(e.s),i=Math.abs(t-e.q),r=Math.abs(n-e.r),s=Math.abs(a-e.s);return i>r&&i>s?t=-n-a:r>s?n=-t-a:a=-t-n,this.Hex(t,n,a)}},{key:"getDistanceLine",value:function(e,t){var n=this.cubeDistance(e,t);if(n<this.state.infantryDistance){for(var a=[],i=0;i<=n;i++){var r=this.hexToPixel(this.cubeRound(this.cubeLinearInt(e,t,1/n*i)));a=[].concat(a,r)}this.setState({currentDistanceLine:a})}}},{key:"cubeDistance",value:function(e,t){var n=this.cubeSubtract(e,t),a=n.q,i=n.r,r=n.s;return(Math.abs(a)+Math.abs(i)+Math.abs(r))/2}},{key:"cubeLinearInt",value:function(e,t,n){return this.Hex(this.linearInt(e.q,t.q,n),this.linearInt(e.r,t.r,n),this.linearInt(e.s,t.s,n))}},{key:"linearInt",value:function(e,t,n){return e+(t-e)*n}},{key:"Point",value:function(e,t){return{x:e,y:t}}},{key:"Hex",value:function(e,t,n){return{q:e,r:t,s:n}}},{key:"drawLine",value:function(e,t,n,a,i){var r=e.getContext("2d");r.beginPath(),r.moveTo(t.x,t.y),r.strokeStyle=a,r.lineWidth=i,r.lineTo(n.x,n.y),r.stroke(),r.closePath()}},{key:"fillHex",value:function(e,t,n){var a=this.getHexCornerCoord(t,0),i=this.getHexCornerCoord(t,1),r=this.getHexCornerCoord(t,2),s=this.getHexCornerCoord(t,3),o=this.getHexCornerCoord(t,4),c=this.getHexCornerCoord(t,5),l=e.getContext("2d");l.fillStyle=n,l.globalAlpha=.7,l.moveTo(a.x,a.y),l.lineTo(i.x,i.y),l.lineTo(r.x,r.y),l.lineTo(s.x,s.y),l.lineTo(o.x,o.y),l.lineTo(c.x,c.y),l.closePath(),l.fill()}},{key:"drawHexCoordinates",value:function(e,t,n){var a=e.getContext("2d");a.fillText(n.q,t.x+6,t.y),a.fillText(n.r,t.x-3,t.y+15),a.fillText(n.s,t.x-12,t.y)}},{key:"findInBlueHexes",value:function(e,t,n){return this.state.blueHexes.filter((function(a){return a.q===e&&a.r===t&&a.s===n}))}},{key:"findInGreyHexes",value:function(e,t,n){return this.state.greyHexes.filter((function(a){return a.q===e&&a.r===t&&a.s===n}))}},{key:"drawNeighborsClick",value:function(e){for(var t=this,n=this.state.canvasSize,a=n.canvasWidth,i=n.canvasHeight,r=this.state.hexParameters,s=r.hexWidth,o=r.hexHeight,c=[],l=0;l<=5;l++){var h=this.getCubeNeighbor(this.Hex(e.q,e.r,e.s),l),u=h.q,d=h.r,g=h.s,x=this.hexToPixel(this.Hex(u,d,g)),v=x.x,f=x.y;v>s/2&&v<a-s/2&&f>o/2&&f<i-o/2&&(c.push([u,d,g]),this.setState({cubeNeighborsArray:c},(function(){console.log(t.state.cubeNeighborsArray)})))}}},{key:"drawNeighborsMove",value:function(e){for(var t=this.state.canvasSize,n=t.canvasWidth,a=t.canvasHeight,i=this.state.hexParameters,r=i.hexWidth,s=i.hexHeight,o={q:0,r:0,s:0},c=0;c<=5;c++){var l=this.getCubeNeighbor(this.Hex(e.q,e.r,e.s),c),h=l.q,u=l.r,d=l.s,g=this.hexToPixel(this.Hex(h,u,d)),x=g.x,v=g.y;0!==this.findInBlueHexes(h,u,d).length&&(this.findInBlueHexes(h,u,d),console.log(h,u,d),x>r/2&&x<n-r/2&&v>s/2&&v<a-s/2&&(o.q=h,o.r=u,o.s=d,this.setState({previousPlayerPosition:o}),this.drawHex(this.canvasCoordinates,this.Point(x,v),"blue",2))),0!==this.findInGreyHexes(h,u,d).length&&(this.findInGreyHexes(h,u,d),x>r/2&&x<n-r/2&&v>s/2&&v<a-s/2&&(o.q=h,o.r=u,o.s=d,this.setState({previousPlayerPosition:o}),this.drawHex(this.canvasCoordinates,this.Point(x,v),"blue",2)))}}},{key:"handleMouseMove",value:function(e){var t=this.state.canvasSize,n=t.canvasWidth,a=t.canvasHeight,i=this.state.hexParameters,r=i.hexWidth,s=i.hexHeight,o=this.state.canvasPosition,c=o.left,l=o.top,h=e.pageX-c,u=e.pageY-l,d=this.cubeRound(this.pixelToHex(this.Point(h,u))),g=d.q,x=d.r,v=d.s,f=this.hexToPixel(this.Hex(g,x,v)),y=f.x,b=f.y;if("firing"===this.state.phase){var m=this.state.playerPosition,H=this.getDistanceLine(this.Hex(m.q,m.r,m.s),this.Hex(g,x,v));this.setState({firingDistance:H})}y>r/2&&y<n-r/2&&b>s/2&&b<a-s/2&&this.setState({currentHex:{q:g,r:x,s:v,x:y,y:b}})}},{key:"handleClick",value:function(e){var t=this,n=this.state.canvasPosition,a=n.left,i=n.top,r=e.pageX-a,s=e.pageY-i,o=this.cubeRound(this.pixelToHex(this.Point(r,s))),c=o.q,l=o.r,h=o.s;this.drawNeighborsClick(this.Hex(this.state.previousPlayerPosition.q,this.state.previousPlayerPosition.r,this.state.previousPlayerPosition.s)),this.setState({clickCoordsHolder:[].concat(Object(y.a)(this.state.clickCoordsHolder),[this.state.currentHex])},(function(){if("movement"==t.state.phase)for(var e=0;e<=t.state.cubeNeighborsArray.length;e++)null!=t.state.cubeNeighborsArray[e]&&t.state.currentHex.q===t.state.cubeNeighborsArray[e][0]&&t.state.currentHex.r===t.state.cubeNeighborsArray[e][1]&&t.state.currentHex.s===t.state.cubeNeighborsArray[e][2]&&(t.fetchNewUnitPosition(c,l,h),console.log(t.state.currentHex),console.log(t.state.cubeNeighborsArray[e]),console.log(t.state.clickCoordsHolder.slice(-1)[0]))}))}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement("canvas",{ref:function(t){return e.canvasHex=t}}," "),i.a.createElement("canvas",{ref:function(t){return e.canvasCoordinates=t},onMouseMove:this.handleMouseMove,onClick:this.handleClick}," "))}}]),t}(i.a.Component),p=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(h.a)(t).call(this))).state={currentPlayer:{name:""},games:[],gameSelectedID:"none",gameSelected:!1},e}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.setState(Object(v.a)({},this.state,{currentPlayer:Object(v.a)({},this.state.currentPlayer,{name:this.props.currentPlayer.name})}))}},{key:"componentDidMount",value:function(){var e=this;console.log(this.state.currentPlayer.name);var t=[];fetch("http://localhost:3000/games").then((function(e){return e.json()})).then((function(n){for(var a=n.filter((function(e){return e.players})).map((function(e){return e.players})),i=0;i<=a.length-1;i++){var r=a[i].filter((function(e){return e.name})).map((function(e){return e.name}));r[0]===e.state.currentPlayer.name?t.push(n[i]):r[1]===e.state.currentPlayer.name&&t.push(n[i])}e.setState({games:t}),console.log(e.state.games)}))}},{key:"handleClick",value:function(e){e.preventDefault();var t=e.currentTarget.attributes["game-id"].value;console.log(t),this.setState(Object(v.a)({},this.state,{gameSelectedID:t,gameSelected:!0}))}},{key:"render",value:function(){console.log(this.state.gameSelectedID);var e="none"!==this.state.gameSelectedID?i.a.createElement(H,{id:this.state.gameSelectedID}):null;if(!0===this.props.login&&!1===this.state.gameSelected){var t=this.state.games;return i.a.createElement("ol",null,e,"Games Name-Turn-Phase",t.map(function(e,t){var n=this;return i.a.createElement("li",{key:t},e.name," "+e.turn," "+e.phase,i.a.createElement("button",{onClick:function(e){return n.handleClick(e)},"game-id":e.id},"select"))}.bind(this)))}return!0===this.state.gameSelected?i.a.createElement("ol",null,e):i.a.createElement(g.a,{to:"/"})}}]),t}(a.Component),C=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.loginClicked,n=e.onLoginClicked,a=e.onSetCurrentPlayer,r=e.onLogin,s=e.currentPlayer,o=e.login;return i.a.createElement("div",null,i.a.createElement(d.b,null,i.a.createElement(g.b,{exact:!0,path:"/login",render:function(){return i.a.createElement(f,{loginClicked:t,onLoginClicked:n,onSetCurrentPlayer:a,onLogin:r})}}),i.a.createElement(g.b,{exact:!0,path:"/gameselect",render:function(){return i.a.createElement(p,{currentPlayer:s,login:o})}})))}}]),t}(a.Component),k=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(l.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(i)))).handleClick=function(){n.props.onLoginClicked()},n.handleLogout=function(){n.props.onLogout()},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return!1===this.props.login?i.a.createElement(i.a.Fragment,null,i.a.createElement(d.c,{to:"/login"},i.a.createElement("button",{onClick:this.handleClick},"Login")),i.a.createElement(d.c,{to:"/signup"},i.a.createElement("button",null,"Sign Up"))):i.a.createElement("div",null,i.a.createElement("button",{onClick:this.handleLogout},"Logout"))}}]),t}(a.Component),P=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(h.a)(t).call(this))).onLogin=function(){e.setState({login:!0})},e.onSetCurrentPlayer=function(t){e.setState({currentPlayer:t})},e.onLoginClicked=function(){e.setState({loginClicked:!e.state.loginClicked})},e.onLogout=function(){e.setState({loginClicked:!1,login:!1})},e.state={loginClicked:!1,login:!1,currentPlayer:{}},e}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(k,{loginClicked:this.state.loginClicked,onLogin:this.onLogin,onLoginClicked:this.onLoginClicked,login:this.state.login,onLogout:this.onLogout,currentPlayer:this.state.currentPlayer}),i.a.createElement(C,{loginClicked:this.state.loginClicked,onLogin:this.onLogin,onLoginClicked:this.onLoginClicked,login:this.state.login,onLogout:this.onLogout,onSetCurrentPlayer:this.onSetCurrentPlayer,currentPlayer:this.state.currentPlayer}))}}]),t}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(d.a,null,i.a.createElement(g.b,{path:"/",component:P})," "),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[26,1,2]]]);
//# sourceMappingURL=main.e733d41b.chunk.js.map